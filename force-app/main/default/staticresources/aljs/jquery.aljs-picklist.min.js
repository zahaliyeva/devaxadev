if("undefined"==typeof jQuery.aljs)throw new Error("Please include the ALJS initializer file");!function(e){var s=function(s,o){this.$el=e(s),this.settings=o,this.obj={},this.bindTrigger(),this.bindChoices()};s.prototype={constructor:s,bindTrigger:function(){var s=this,o=this.$el;this.obj.$trigger=e(".slds-lookup__search-input",o),this.obj.$dropdown=e(".slds-dropdown__list",o),this.obj.$choices=e(".slds-dropdown__list > li > span",o).prop("tabindex",1),this.$el.on("keyup",s,s.processKeypress).find(".slds-lookup__search-input + .slds-button").css("pointer-events","none"),this.obj.$trigger.unbind().click(function(o){return o.stopPropagation(),s.obj.id=e(this).attr("id"),s.$el.hasClass("slds-is-open")?(s.$el.removeClass("slds-is-open"),s.obj.$dropdown.unbind("keyup",s.processKeypress)):(e('[data-aljs="picklist"]').not(s.$el).picklist("close"),s.$el.addClass("slds-is-open"),null===s.obj.valueId||"undefined"==typeof s.obj.valueId?s.focusedIndex=null:s.focusedIndex=s.obj.$dropdown.find("li > span").index(s.obj.$dropdown.find("#"+s.obj.valueId)),s.focusOnElement()),!1}),e("body").click(function(){s.$el.removeClass("slds-is-open")})},processKeypress:function(e){var s=e.data,o=s.obj.$choices.length;if(s.$el.hasClass("slds-is-open"))switch(e.which){case 40:null===s.focusedIndex?s.focusedIndex=0:s.focusedIndex=s.focusedIndex===o-1?0:s.focusedIndex+1,s.focusOnElement();break;case 38:null===s.focusedIndex?s.focusedIndex=o-1:s.focusedIndex=0===s.focusedIndex?o-1:s.focusedIndex-1,s.focusOnElement();break;case 27:s.$el.picklist("close");break;case 13:if(null!==s.focusedIndex){var n=s.obj.$choices.eq(s.focusedIndex).attr("id");s.setValueAndUpdateDom(n)}}else 13===e.which&&(s.$el.addClass("slds-is-open"),s.focusOnElement());return!1},focusOnElement:function(){null!==this.focusedIndex&&this.obj.$choices.eq(this.focusedIndex).focus()},bindChoices:function(){var s=this;this.obj.$valueContainer=e(".slds-lookup__search-input",this.$el),this.obj.$choices.unbind().click(function(o){o.stopPropagation();var n=e(this).closest("span").attr("id");s.setValueAndUpdateDom(n)})},setValueAndUpdateDom:function(e){var s=this,o=s.$el.find("#"+e),n=s.obj.$choices.index(o);this.obj.value=o.text().trim(),this.obj.valueId=e,this.$el.removeClass("slds-is-open"),this.obj.$trigger.trigger("change.aljs.picklist").focus(),this.obj.$valueContainer.val(this.obj.value),this.obj.$choices.removeClass("slds-is-selected"),o.addClass("slds-is-selected"),s.focusedIndex=n,s.settings.onChange(s.obj)},setValue:function(e,s){this.setValueAndUpdateDom(e),s&&this.settings.onChange(this.obj)},getValueId:function(){return this.obj.valueId},getValue:function(){return this.obj},close:function(){this.$el.removeClass("slds-is-open")}},e.fn.picklist=function(o){var n,i=arguments,t=e.extend({assetsLocation:e.aljs.assetsLocation,onChange:function(e){}},"object"==typeof o?o:{});if(this.each(function(){var l=e(this),d=l.data("aljs-picklist");if(!d){var c=new s(this,t);l.data("aljs-picklist",d=c)}"string"==typeof o&&(n=d[o](i[1],i[2]))}),void 0===n||n instanceof s)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+option+" function)");return n}}(jQuery);